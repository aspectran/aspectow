<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE aspectran PUBLIC "-//ASPECTRAN//DTD Aspectran Configuration 6.0//EN"
        "http://aspectran.github.io/dtd/aspectran-6.dtd">
<aspectran>

    <description style="apon">
        |
        |Use the command '{{GREEN}}undertow{{reset}}' to control the Undertow Server.
        |Since Undertow Server is running, have your web browser point to:
        |   {{81}}http://localhost:8081/{{fg:reset}}
        |
    </description>

    <!-- Development -->
    <environment profile="dev">
        <properties>
            <item name="redis.uri.session_db" value="%{classpath:redis-dev.properties^uri.session_db}"/>
            <item name="redis.uri.chat_db" value="%{classpath:redis-dev.properties^uri.chat_db}"/>
            <item name="redis.channel.public_chat" value="%{classpath:redis-dev.properties^channel.public_chat}"/>
            <item name="redis.channel.private_chat" value="%{classpath:redis-dev.properties^channel.private_chat}"/>
            <item name="redis.channel.random_chat" value="%{classpath:redis-dev.properties^channel.random_chat}"/>
            <item name="redis.channel.lobby_chat" value="%{classpath:redis-dev.properties^channel.lobby_chat}"/>
        </properties>
    </environment>

    <!-- Production - Oracle Cloud -->
    <environment profile="prod">
        <properties>
            <item name="redis.uri.session_db" value="%{classpath:redis-prod.properties^uri.session_db}"/>
            <item name="redis.uri.chat_db" value="%{classpath:redis-prod.properties^uri.chat_db}"/>
            <item name="redis.channel.public_chat" value="%{classpath:redis-prod.properties^channel.public_chat}"/>
            <item name="redis.channel.private_chat" value="%{classpath:redis-prod.properties^channel.private_chat}"/>
            <item name="redis.channel.random_chat" value="%{classpath:redis-prod.properties^channel.random_chat}"/>
            <item name="redis.channel.lobby_chat" value="%{classpath:redis-prod.properties^channel.lobby_chat}"/>
        </properties>
    </environment>

    <!-- Production - GCP -->
    <environment profile="prod-gcp">
        <properties>
            <item name="redis.uri.session_db" value="%{classpath:redis-prod-gp.properties^uri.session_db}"/>
            <item name="redis.uri.chat_db" value="%{classpath:redis-prod-gcp.properties^uri.chat_db}"/>
            <item name="redis.channel.public_chat" value="%{classpath:redis-prod-gcp.properties^channel.public_chat}"/>
            <item name="redis.channel.private_chat" value="%{classpath:redis-prod-gcp.properties^channel.private_chat}"/>
            <item name="redis.channel.random_chat" value="%{classpath:redis-prod-gcp.properties^channel.random_chat}"/>
            <item name="redis.channel.lobby_chat" value="%{classpath:redis-prod-gcp.properties^channel.lobby_chat}"/>
        </properties>
    </environment>

    <bean id="basePath" class="com.aspectran.core.support.BasePathFactoryBean"/>
    <bean id="currentEnvironment" class="com.aspectran.core.support.CurrentEnvironmentFactoryBean"/>
    <bean id="currentTranslet" class="com.aspectran.core.support.CurrentTransletFactoryBean" scope="request"/>
    <bean id="currentActivityData" class="com.aspectran.core.support.CurrentActivityDataFactoryBean" scope="request"/>

    <aspect id="defaultTransletSettings">
        <description>
            Define an aspect to inject the default settings into all translets.
        </description>
        <settings>
            <setting name="format.indentSize" value="2"/>
            <setting name="format.dateFormat" value="yyyy-MM-dd"/>
            <setting name="format.dateTimeFormat" value="yyyy-MM-dd HH:mm:ss"/>
            <setting name="format.nullWritable" value="true"/>
        </settings>
    </aspect>

    <append file="/config/error-report.xml"/>
    <append file="/config/mybatis/db-tx-config.xml"/>
    <append file="/config/redis/redis-config.xml"/>
    <append file="/config/server/undertow-config.xml"/>
    <append file="/config/server/undertow-support.xml"/>
    <append file="/config/web/web-config.xml"/>

</aspectran>